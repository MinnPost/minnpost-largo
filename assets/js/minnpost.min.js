"use strict";function mp_analytics_tracking_event(type,category,action,label,value){"undefined"!=typeof ga&&(void 0===value?ga("send",type,category,action,label):ga("send",type,category,action,label,value))}function trackShare(text,position){(jQuery("body ").hasClass("logged-in")||"Email"!==text)&&(mp_analytics_tracking_event("event","Share - "+position,text,location.pathname),"undefined"!=typeof ga&&("Facebook"!==text&&"Twitter"!==text||("Facebook"==text?ga("send","social",text,"Share",location.pathname):ga("send","social",text,"Tweet",location.pathname))))}!function($){$(".m-entry-share-top a").click(function(e){trackShare($(this).text().trim(),"top")}),$(".m-entry-share-bottom a").click(function(e){trackShare($(this).text().trim(),"bottom")}),$("#navigation-featured a").click(function(e){mp_analytics_tracking_event("event","Featured Bar Link","Click",this.href)}),$("a.glean-sidebar").click(function(e){mp_analytics_tracking_event("event","Sidebar Support Link","Click",this.href)}),$("a",$(".o-site-sidebar")).click(function(e){var widget_title=$(this).closest(".m-widget").find("h3").text(),sidebar_section_title="";""===widget_title||(sidebar_section_title=widget_title),mp_analytics_tracking_event("event","Sidebar Link","Click",sidebar_section_title)}),$(document).ready(function(e){if("undefined"!=typeof PUM){PUM.getPopup($(".pum"));var popup_id=PUM.getSettings($(".pum")).id;$(document).on("pumAfterOpen",function(){mp_analytics_tracking_event("event","Popup","Show",popup_id,{nonInteraction:1})}),$(document).on("pumAfterClose",function(){var close_trigger=$.fn.popmake.last_close_trigger;void 0!==close_trigger&&mp_analytics_tracking_event("event","Popup",close_trigger,popup_id,{nonInteraction:1})}),$(".message-close").click(function(e){mp_analytics_tracking_event("event","Popup","Close Button",popup_id,{nonInteraction:1})}),$(".message-login").click(function(e){mp_analytics_tracking_event("event","Popup","Login Link",$(this).attr("href"))}),$(".pum-content a:not( .message-close, .pum-close, .message-login )").click(function(e){mp_analytics_tracking_event("event","Popup","Click",popup_id)})}if("undefined"!=typeof minnpost_membership_data&&""!==minnpost_membership_data.url_access_level){var label=location.pathname,action="Blocked";!0===minnpost_membership_data.current_user.can_access&&(action="Shown"),mp_analytics_tracking_event("event","Member Content",action,label)}})}(jQuery),function($){function manageEmails(){var form=$("#account-settings-form"),full_url=user_account_management_rest.site_url+user_account_management_rest.rest_namespace+"/update-user/",nextEmailCount=1,emailToRemove="",consolidatedEmails=[],newEmails=[],ajax_form_data="";0<$(".m-user-email-list").length&&(nextEmailCount=$(".m-user-email-list > li").length,$('.a-form-caption.a-remove-email input[type="checkbox"]').change(function(event){emailToRemove=$(this).val(),$(".m-user-email-list > li").each(function(index){$(this).contents().get(0).nodeValue!==emailToRemove&&consolidatedEmails.push($(this).contents().get(0).nodeValue)}),$(this).parent().html('Are you sure you want to remove this email? <button type="button" name="a-confirm-removal" id="a-confirm-removal" class="a-button">Confirm</button>'),$("#a-confirm-removal").click(function(event){$(this).parents("li").remove(),$("#_consolidated_emails").val(consolidatedEmails.join(",")),nextEmailCount=$(".m-user-email-list > li").length,form.submit()})})),$(".a-form-caption.a-add-email").click(function(event){event.preventDefault(),$(".a-form-caption.a-add-email").before('<div class="a-input-with-button a-button-sentence"><input type="email" name="_consolidated_emails_array[]" id="_consolidated_emails_array[]" value=""><button type="submit" name="a-add-email-'+nextEmailCount+'" id="a-add-email-'+nextEmailCount+'" class="a-button">Add</button></div>'),nextEmailCount++}),$(form).on("submit",function(event){event.preventDefault(),ajax_form_data=form.serialize(),ajax_form_data+="&rest=true",$.ajax({url:full_url,type:"post",beforeSend:function(xhr){xhr.setRequestHeader("X-WP-Nonce",user_account_management_rest.nonce)},dataType:"json",data:ajax_form_data}).done(function(data){newEmails=$('input[name="_consolidated_emails_array[]"]').map(function(){return $(this).val()}).get(),$.each(newEmails,function(index,value){nextEmailCount+=index,$(".m-user-email-list").append("<li>"+value+'<ul class="a-form-caption a-user-email-actions"><li class="a-form-caption a-make-primary-email"><input type="radio" name="primary_email" id="primary_email_'+nextEmailCount+'" value="'+value+'"><label for="primary_email_'+nextEmailCount+'"><small>Make Primary</small></label></li><li class="a-form-caption a-remove-email"><input type="checkbox" name="remove_email['+nextEmailCount+']" id="remove_email_'+nextEmailCount+'" value="'+value+'"><label for="remove_email_'+nextEmailCount+'"><small>Remove</small></label></li></ul></li>')}),$(".m-form-change-email .a-input-with-button").remove()})})}jQuery(document).ready(function($){0<$(".m-form-email").length&&manageEmails(),0<$(".m-form-newsletter-shortcode").length&&($(".m-form-newsletter-shortcode fieldset").before('<div class="m-hold-message"></div>'),$(".m-form-newsletter-shortcode form").submit(function(event){var that=this;event.preventDefault();var button=$("button",this);button.prop("disabled",!0),button.text("Processing");var ajax_form_data=$(this).serialize();ajax_form_data+="&ajaxrequest=true&subscribe",$.ajax({url:params.ajaxurl,type:"post",dataType:"json",data:ajax_form_data}).done(function(response){var url,message="";if(!0===response.success){$("fieldset",that).hide(),button.text("Thanks");var analytics_action="Signup";switch(response.data.user_status){case"existing":analytics_action="Update",message="Thanks for updating your email preferences. They will go into effect immediately.";break;case"new":analytics_action="Signup",message="We have added you to the MinnPost mailing list.";break;case"pending":analytics_action="Signup",message="We have added you to the MinnPost mailing list. You will need to click the confirmation link in the email we sent to begin receiving messages."}""!==response.data.confirm_message&&(message=response.data.confirm_message),"function"==typeof mp_analytics_tracking_event&&(mp_analytics_tracking_event("event","Newsletter",analytics_action,location.pathname),url=location.pathname,gtag("event","conversion",{send_to:"AW-976620175/jqCyCL7atXkQj5XY0QM",event_callback:function(){void 0!==url&&(window.location=url)}}))}else button.prop("disabled",!1),button.text("Subscribe"),"function"==typeof mp_analytics_tracking_event&&mp_analytics_tracking_event("event","Newsletter","Fail",location.pathname);$(".m-hold-message").html('<div class="m-form-message m-form-message-info">'+message+"</div>")}).fail(function(response){$(".m-hold-message").html('<div class="m-form-message m-form-message-info">An error has occured. Please try again.</div>'),button.prop("disabled",!1),button.text("Subscribe"),"function"==typeof mp_analytics_tracking_event&&mp_analytics_tracking_event("event","Newsletter","Fail",location.pathname)}).always(function(){event.target.reset()})}))})}(jQuery),jQuery(document).ready(function($){var container,button,menu,links,i,len;if((container=document.getElementById("navigation-primary"))&&void 0!==(button=container.getElementsByTagName("button")[0]))if(void 0!==(menu=container.getElementsByTagName("ul")[0])){for(menu.setAttribute("aria-expanded","false"),-1===menu.className.indexOf("menu")&&(menu.className+=" menu"),button.onclick=function(){-1!==container.className.indexOf("toggled")?(container.className=container.className.replace(" toggled",""),button.setAttribute("aria-expanded","false"),menu.setAttribute("aria-expanded","false")):(container.className+=" toggled",button.setAttribute("aria-expanded","true"),menu.setAttribute("aria-expanded","true"))},i=0,len=(links=menu.getElementsByTagName("a")).length;i<len;i++)links[i].addEventListener("focus",toggleFocus,!0),links[i].addEventListener("blur",toggleFocus,!0);!function(container){var touchStartFn,i,parentLink=container.querySelectorAll(".menu-item-has-children > a, .page_item_has_children > a");if("ontouchstart"in window)for(touchStartFn=function(e){var i,menuItem=this.parentNode;if(menuItem.classList.contains("focus"))menuItem.classList.remove("focus");else{for(e.preventDefault(),i=0;i<menuItem.parentNode.children.length;++i)menuItem!==menuItem.parentNode.children[i]&&menuItem.parentNode.children[i].classList.remove("focus");menuItem.classList.add("focus")}},i=0;i<parentLink.length;++i)parentLink[i].addEventListener("touchstart",touchStartFn,!1)}(container)}else button.style.display="none";function toggleFocus(){for(var self=this;-1===self.className.indexOf("menu");)"li"===self.tagName.toLowerCase()&&(-1!==self.className.indexOf("focus")?self.className=self.className.replace(" focus",""):self.className+=" focus"),self=self.parentElement}}),jQuery(document).ready(function($){0<$("#user-account-access ul").length&&$("#user-account-access > li > a").on("click",function(event){$("#user-account-access ul").toggleClass("visible"),event.preventDefault()})});